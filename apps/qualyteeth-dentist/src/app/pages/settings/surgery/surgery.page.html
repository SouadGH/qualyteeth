<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>
      Cabinets
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">

  <!-- <button mat-fab color="primary" (click)="add()" style="position: absolute; right: 16px; bottom: 32px;">
    <mat-icon>add</mat-icon>
  </button> -->

  <mat-fab-menu #matFabMenu color="primary" [fabButtons]="addBtns" direction="top" (onFabMenuItemSelected)="onFabMenuItemSelected($event)" style="position: absolute; right: 16px; bottom: 32px;"></mat-fab-menu>

  <ion-progress-bar type="indeterminate" *ngIf="loading"></ion-progress-bar>

  <div style="padding: 16px;">

    <ion-grid fixed style="max-width: 760px; width: 100%;">
      <ion-row>
        <ion-col>
          <h5>Cabinets</h5>

          <table mat-table [dataSource]="surgeries" class="mat-elevation-z1" *ngIf="surgeries.length > 0">

            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef> Identifiant </th>
              <td mat-cell *matCellDef="let s">{{ s.id }}</td>
            </ng-container>

            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef> Nom </th>
              <td mat-cell *matCellDef="let s">{{ s.name }}</td>
            </ng-container>

            <ng-container matColumnDef="dentists">
              <th mat-header-cell *matHeaderCellDef> Dentistes </th>
              <td mat-cell *matCellDef="let s">{{ s.dentists != null ? s.dentists.length : '' }}</td>
            </ng-container>

            <!-- <ng-container matColumnDef="patients">
              <th mat-header-cell *matHeaderCellDef> Patients </th>
              <td mat-cell *matCellDef="let s">{{ s.patients != null ? s.patients.length : '' }}</td>
            </ng-container> -->

            <ng-container matColumnDef="default">
              <th mat-header-cell *matHeaderCellDef> Actif </th>
              <td mat-cell *matCellDef="let s">
                <mat-icon *ngIf="s.active" style="color: green;">check_circle</mat-icon>
                <mat-icon *ngIf="!s.active">cancel</mat-icon>
              </td>
            </ng-container>

            <ng-container matColumnDef="edit">
              <th mat-header-cell *matHeaderCellDef> &nbsp; </th>
              <td mat-cell *matCellDef="let s" style="text-align: right;">
                <button mat-icon-button (click)="more($event, s)">
                  <mat-icon>more_vert</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="columns"></tr>
            <tr mat-row *matRowDef="let row; columns: columns;"></tr>
          </table>

          <div *ngIf="surgeries.length === 0" style="margin-top: 32px;">
            Aucun cabinet - Ajoutez un cabinet en cliquant sur le bouton +
          </div>

        </ion-col>

      </ion-row>
    </ion-grid>

  </div>

</ion-content>

<!-- <ion-content [fullscreen]="true">

  <mat-tab-group mat-align-tabs="center" [selectedIndex]="selectedTab" (selectedIndexChange)="selectedTab = $event">
    <mat-tab label="Cabinet actif" style="padding: 16px;">
      <ion-progress-bar type="indeterminate" *ngIf="loading"></ion-progress-bar>

      <div style="padding: 16px;" *ngIf="!loading">

        <ion-grid fixed style="position: relative; max-width: 760px; width: 100%;">

          <button mat-icon-button style="position: absolute; top: 8px; right: 8px;" (click)="pop($event)">
            <mat-icon>more_vert</mat-icon>
          </button>

          <ion-row style="margin-top: 24px;">
            <ion-col style="text-align: center;">
              <h2>{{ activeSurgery.name }}</h2>
              <h6>Code: {{ activeSurgery.id }}</h6>
            </ion-col>
          </ion-row>

          <ion-row>
            <ion-col>

              <ion-list lines="none">
                <ion-item>
                  <ion-icon name="bandage-outline" slot="start"></ion-icon>
                  <ion-label>Services</ion-label>
                  <ion-badge slot="end">{{ services.length }}</ion-badge>
                </ion-item>

                <ion-item>
                  <ion-icon name="medkit-outline" slot="start"></ion-icon>
                  <ion-label>Dentistes</ion-label>
                  <ion-badge slot="end">{{ dentists.length }}</ion-badge>
                </ion-item>

                <ion-item>
                  <ion-icon name="people-outline" slot="start"></ion-icon>
                  <ion-label>Patients</ion-label>
                  <ion-badge slot="end">{{ patients.length }}</ion-badge>
                </ion-item>

                <ion-item>
                  <ion-icon name="medical-outline" slot="start"></ion-icon>
                  <ion-label>Traitements</ion-label>
                  <ion-badge slot="end">{{ treatments.length }}</ion-badge>
                </ion-item>
              </ion-list>

            </ion-col>
          </ion-row>

        </ion-grid>
      </div>
    </mat-tab>

    <mat-tab label="Changer de cabinet">
      <ion-progress-bar type="indeterminate" *ngIf="loading"></ion-progress-bar>
      
      <div style="padding: 16px;">
        
        <ion-grid fixed style="position: relative;">

          <button mat-icon-button style="position: absolute; top: 8px; right: 8px;" (click)="pop($event)">
            <mat-icon>more_vert</mat-icon>
          </button>

          <ion-row style="margin-top: 24px;">
            <ion-col style="text-align: center;">
              <h2>Cabinets</h2>
              <h6 *ngIf="activeSurgery != null">Cabinet actif: {{ activeSurgery.name }}</h6>
            </ion-col>
          </ion-row>

          <ion-row style="margin-top: 24px;">
            <ion-col style="text-align: center;">
              <mat-form-field style="width: 320px;">
                <mat-label>Cabinets</mat-label>
                <mat-select [(value)]="activeSurgery" (selectionChange)="onSurgeryChange($event)">
                  <mat-option *ngFor="let s of surgeries" [value]="s">{{ s.name }}</mat-option>
                </mat-select>
              </mat-form-field>

            </ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </mat-tab>

  </mat-tab-group>

</ion-content> -->